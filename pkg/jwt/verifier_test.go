package jwt

import (
	"testing"

	jwtgo "github.com/dgrijalva/jwt-go"
	"github.com/stretchr/testify/require"
)

//AccessTokenClaims ...
type AccessTokenClaims struct {
	jwtgo.StandardClaims
	Email string `json:"email"`
	Name  string `json:"name"`
}

func TestVerifyToken_OK(t *testing.T) {
	token := "eyJhbGciOiJSUzI1NiIsImtpZCI6InB1YmxpYzo0YzU3NjNmZi1hYTlkLTQwYmYtOGFmZC0wODk0NjM4ZjJiOTUiLCJ0eXAiOiJKV1QifQ.eyJhdF9oYXNoIjoiU0FKWXlxVnhfSk9VeXo1ZVpuYklaUSIsImF1ZCI6WyJ0aWtpLWNvbnNvbGUiXSwiYXV0aF90aW1lIjoxNjMzNDMwNTAzLCJlbWFpbCI6Imh1bmcubmd1eWVuOEB0aWtpLnZuIiwiZXhwIjoxNjMzNTE2OTA0LCJpYXQiOjE2MzM0MzA1MDQsImlzcyI6Imh0dHBzOi8vYXBpLnRhbGEueHl6LyIsImp0aSI6Ijg0NzRjZTFmLTY1YjItNDZiNy1iNDEwLWM5YzgxZjA0Y2ZhNSIsIm5hbWUiOiJIdW5nLiBOZ3V5ZW4gS2ltIiwibm9uY2UiOiIiLCJyYXQiOjE2MzM0MzA0OTgsInNpZCI6ImM4N2MxNzk0LTc5ZmQtNDJhNi1iZTBmLTFhYzE4OTE3MGM4NSIsInN1YiI6ImN1c3RvbWVyczoxMDAxMDAyMTYiLCJ0cm4iOiJhY2NvdW50czoxMDA3OTI1In0.e65imOmD8e1J5ySY-Yfmc1EU9Brtp6NvGVNIN9hsm7ZFC3UCa1Q22oq7ulDxzM6MScbYo-WxRE8f42tlVdl6PiMrIMiimMn_cxQNywMKVcFxITxePgKnboSNm2SJ372WmF01yQuwAljOkTR1N8lvbBd9jaPu3UbmFATQ_N1rIek25jbPrn-n4fpEtopIZl3HuCT98P-YuSUBhC3TdtpV_om0zrAPjCN1--KA1RdclI0bRkdfpy-FyP4pkXxS_eoQENmzsTiYCMY7WdGGrIMGz5GNMQqnwIKGKpOmb9eAG-NBMcVXP5Lwwt_LEJNesxDGBHQfQxk_rcx8b4k5SONkznTGWl-OCA45wjkM4oOeOWDpbH6zimJZwW3DCqR-iRqzNyblX0sUrHIOcRyrajD3npwSKqVpn6MpIkwlePjv37gYzJ8ZCd6za9LLWWLqz4qyZ2A6Pmr-gTv2nMKP9iPaoJ1BgqYegmL8HzjHQOT1l6oGI-nzriLG7qa1qLcbuRheZ7VzeZSZsGgZ5kQrreRahh_PU7PtZpYeZFYN_RH81TbOH2NX2x_7hgKe_JTHu1xyZrVsCT-LHfsXJU6HEPsw0OOikThWOc7YLPZIi0d6QC6tKC48-BPECxOwq5qb88zMqW2k7PtJ46_8_Nd708M2K9Bvg9KW2RK7hlEODqMycfA"
	v, err := NewVerifier("LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQ0lqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUF1TUtucDQ0ZDdSK0g4cXlEUkEwdwp2RmNsSXlqblUvVzV4d1V0dFdDUG94ZkhkeVJZVC9uRU9ScXZTQmViSjRGZHl6ekZ3eFhpTElwUjl3QzFaZWdGCkVOL1RvNFJVM1VCVEJtZTQ4SXlDOHdha0hSQVlDaDBGVEMrbjMxSE81R2hlWVRvdlU0ZTgrK3NXSkJZelZyNXEKRUlsRUhOenpVcVd0NVozSU5ZeHFtN1E0M1JPZW5mWWJKd1FKVFlsTEJLSGVJQXRZWGFYbXYxY1prVkw2Y2p3WgpsSktadzlqNHJTbXJKMTliSEd1SktyME84VW1aSFhQdVZKdDQveWk3SHRaSC9oVStJOWU2TDhwb29veC9KbEZ1CnM3Q3NoVTZOdndLSkNMTUhTVDlNTVJZS1RsQnRyUFh2RWxBMlRSYTJlVUZGa21SWkphZ1hHWHZSVVQ1NlRCSDAKSUlSczcwT0xCUkpIS1VROWRqRy81MndHa3lXWmhnZytRdTdNMHVRNUphZkJ1ekF6a2k4Vm5lTUsyT0lmQ2VtSwpVeU41ckZXOUlHN09rOXgwWlRSVGF0L1Z0SElldGw0cmJBdWdNeGhnNE5sbWtTSzRxQkNDbU9xeVpYRjdEbmF3CjBuMWwwa0lFTDRtelNrZjNBYTNSYm5NUXJRbXg1VWk2Z1FBQWt5Rkk0eTh3aGJGNFFhOUtLTHlTVHFjTVV4VHUKdFFRY3RWSTNGdGhENmN0SmZrVCtIYjVXVXM5YndXMkhmWEM5OGpHTW9WNnBDZlN4akZwY1FhOVMzKzZBSDFkVQorcWErZ2ZPZ3FMelNabE9wYVBDWFpZU0dPNjBDTzhqS3J1TUJ6c1V1SDI0RHd4WUFndVBOTEU4OGM0aWIzMDNiCkFoWU0wNU81b0pzaHdrdlpTazNvT21rQ0F3RUFBUT09Ci0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLQo=",
		"RS256")
	require.NoError(t, err)

	claims := &AccessTokenClaims{}
	err = v.Verify(token, claims)
	require.NoError(t, err)
}
